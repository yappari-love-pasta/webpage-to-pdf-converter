# 📄 Webpage to PDF/JPEG Converter

閲覧中のウェブページ全体を1枚のJPEGまたはPDFとして保存するChrome拡張機能です。

## ✨ 主要機能

- **フルページキャプチャ**: スクロールが必要な長いページも1枚の画像として保存
- **URLヘッダー追加**: オプションでキャプチャ元のURLと日時をヘッダーに追加
- **複数フォーマット対応**: JPEG、PDF、または両方の形式で保存可能
- **プレビュー機能**: 保存前にキャプチャ結果を確認できる
- **ローカル実行**: すべての処理がローカルで完結し、外部サーバーを使用しない

## 🚀 セットアップ手順

### Chromeに拡張機能をロード

1. Chromeブラウザで `chrome://extensions/` を開く
2. 右上の「デベロッパーモード」をONにする
3. 「パッケージ化されていない拡張機能を読み込む」をクリック
4. このプロジェクトのディレクトリを選択

## 📖 使い方

### 基本的な使い方

1. **キャプチャしたいウェブページを開く**
2. **拡張機能のアイコンをクリック**
   - ツールバーに表示されているアイコンをクリック
3. **プレビューが新しいタブで開く**
   - キャプチャされたページのプレビューが表示されます
4. **オプションを選択**
   - 「URLをヘッダーに含める」トグルスイッチでURL表示を切り替え
5. **保存形式を選択**
   - 「JPEGで保存」: JPEG形式で保存
   - 「PDFで保存」: PDF形式で保存
   - 「両方で保存」: JPEGとPDFの両方で保存

### URLヘッダーについて

「URLをヘッダーに含める」をONにすると、キャプチャ画像の上部に以下の情報が追加されます:

- キャプチャ元のURL
- キャプチャ日時

ヘッダーは白い背景に黒い文字で表示されます。

## 📁 ファイル構成

```
webpage-pdf-convertor/
├── manifest.json          # Chrome拡張機能の設定ファイル
├── background.js          # バックグラウンドスクリプト（アイコンクリック処理）
├── content.js             # コンテンツスクリプト（ページキャプチャ）
├── dashboard.html         # プレビュー画面のHTML
├── dashboard.js           # プレビュー画面のロジック
├── icons/                 # 拡張機能のアイコン
│   ├── icon16.png
│   ├── icon48.png
│   ├── icon128.png
│   └── README.md
├── libs/                  # 外部ライブラリ
│   ├── html2canvas.min.js
│   └── jspdf.umd.min.js
├── LIBRARY_SETUP.md       # ライブラリセットアップガイド
└── README.md              # このファイル
```

## 🔧 技術仕様

- **Manifest Version**: V3
- **必要な権限**:
  - `tabs`: タブ情報の取得
  - `activeTab`: アクティブなタブへのアクセス
  - `scripting`: コンテンツスクリプトの実行
  - `downloads`: ファイルのダウンロード
- **使用ライブラリ**:
  - [html2canvas](https://html2canvas.hertzen.com/) v1.4.1: ページのキャプチャ
  - [jsPDF](https://github.com/parallax/jsPDF) v2.5.1: PDF生成

## ⚠️ 制限事項

- **クロスオリジンリソース**: 外部ドメインの画像が含まれる場合、正しくキャプチャされない可能性があります
- **動的コンテンツ**: JavaScriptで動的に生成されるコンテンツは、タイミングによってキャプチャされない場合があります
- **iframe**: 一部のiframe内のコンテンツはキャプチャできない場合があります
- **大きなページ**: 非常に長いページの場合、メモリ使用量が増加し、処理に時間がかかる可能性があります

## 🐛 トラブルシューティング

### キャプチャが失敗する場合

1. ページが完全に読み込まれているか確認
2. ブラウザのコンソールでエラーメッセージを確認
3. 拡張機能を一度無効化して再度有効化

### 画像が空白になる場合

- CORSの制限により外部リソースが読み込めていない可能性があります
- ページを再読み込みしてから再度キャプチャを試してください

### ダウンロードが開始されない場合

- Chrome の設定で「ダウンロード前に各ファイルの保存場所を確認する」が有効になっている場合、保存ダイアログが表示されます
- `chrome://settings/downloads` で設定を確認してください

## 📝 ライセンス

このプロジェクトは個人使用を目的としています。

## 🤝 貢献

このプロジェクトは自分専用のツールとして作成されていますが、改善の提案は歓迎します。

---

**注意**: この拡張機能はローカル実行専用です。Chromeウェブストアには公開されていません。
